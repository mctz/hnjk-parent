(function(a){jQuery.fn.multiselect2side=function(b){b=a.extend({selectedPosition:"right",moveOptions:true,labelTop:"\u6700\u4e0a",labelBottom:"\u6700\u4e0b",labelUp:"\u5411\u4e0a",labelDown:"\u5411\u4e0b",labelSort:"\u6392\u5e8f",labelsx:"\u53ef\u9009\u62e9",labeldx:"\u5df2\u9009\u62e9",maxSelected:-1},b);return this.each(function(){var d=a(this),j=a(this).attr("name");if(j.indexOf("[")!=-1)j=j.substring(0,j.indexOf("["));var h=j+"ms2side__dx";j+="ms2side__sx";var l=a(this).attr("size");if(l<6){a(this).attr("size",
"6");l=6}var o="<div class='ms2side__updown'><p class='SelSort' title='\u6392\u5e8f'>"+b.labelSort+"</p><p class='MoveTop' title='\u79fb\u52a8\u4e00\u4e2a\u9009\u9879\u5230\u6700\u4e0a'>"+b.labelTop+"</p><p class='MoveUp' title='\u5411\u4e0a\u79fb\u52a8\u4e00\u4e2a\u9009\u9879'>"+b.labelUp+"</p><p class='MoveDown' title='\u5411\u4e0b\u79fb\u52a8\u4e00\u4e2a\u9009\u9879'>"+b.labelDown+"</p><p class='MoveBottom' title='\u79fb\u52a8\u4e00\u4e2a\u9009\u9879\u5230\u6700\u4e0b'>"+b.labelBottom+"</p></div>";
h="<div class='ms2side__div'>"+(b.selectedPosition!="right"&&b.moveOptions?o:"")+"<div class='ms2side__select'>"+(b.labelsx?"<div class='ms2side__header'>"+b.labelsx+"</div>":"")+"<select title='"+b.labelsx+"' name='"+j+"' id='"+j+"' size='"+l+"' multiple='multiple' ></select></div><div class='ms2side__options'>"+(b.selectedPosition=="right"?"<p class='AddOne' title='\u6dfb\u52a0'>\u6dfb\u52a0 &rsaquo;</p><p class='AddAll' title='\u5168\u90e8\u6dfb\u52a0'>\u5168\u90e8\u6dfb\u52a0 &raquo;</p><p class='RemoveOne' title='\u79fb\u9664'>&lsaquo; \u79fb\u9664</p><p class='RemoveAll' title='\u5168\u90e8\u79fb\u9664'>&laquo; \u5168\u90e8\u79fb\u9664</p>":
"<p class='AddOne' title='\u6dfb\u52a0'>&lsaquo; \u6dfb\u52a0 </p><p class='AddAll' title='\u5168\u90e8\u6dfb\u52a0'>&laquo; \u5168\u90e8\u6dfb\u52a0</p><p class='RemoveOne' title='\u79fb\u9664'>\u79fb\u9664 &rsaquo;</p><p class='RemoveAll' title='\u5168\u90e8\u79fb\u9664'>\u5168\u90e8\u79fb\u9664 &raquo;</p>")+"</div><div class='ms2side__select'>"+(b.labeldx?"<div class='ms2side__header'>"+b.labeldx+"</div>":"")+"<select title='"+b.labeldx+"' name='"+h+"' id='"+h+"' size='"+l+"' multiple='multiple' ></select></div>"+
(b.selectedPosition=="right"&&b.moveOptions?o:"")+"</div>";a(this).after(h).hide();h=a(this).next().find("select");var f=b.selectedPosition=="right"?h.eq(0):h.eq(1),g=b.selectedPosition=="right"?h.eq(1):h.eq(0),t=a(".ms2side__select").eq(0).height();a(this).next().find(".ms2side__options, .ms2side__updown").each(function(){var c=t/2-a(this).height()/2;c>0&&a(this).css("padding-top",c+"px")});a(this).find("option:selected").clone().appendTo(g);a(this).find("option:not(:selected)").clone().appendTo(f);
a.browser.msie&&a.browser.version=="6.0"||f.find("option").eq(0).attr("selected",true);h.change(function(){var c=a(this).parent().parent(),e=f.children(),i=g.children(),m=f.find("option:selected"),k=g.find("option:selected");m.size()==0||b.maxSelected>=0&&m.size()+i.size()>b.maxSelected?c.find(".AddOne").addClass("ms2side__hide"):c.find(".AddOne").removeClass("ms2side__hide");c.find(".RemoveOne, .MoveUp, .MoveDown, .MoveTop, .MoveBottom, .SelSort").addClass("ms2side__hide");i.size()>1&&c.find(".SelSort").removeClass("ms2side__hide");
if(k.size()>0){c.find(".RemoveOne").removeClass("ms2side__hide");if(k.size()<i.size()){k.val()!=i.val()&&c.find(".MoveUp, .MoveTop").removeClass("ms2side__hide");k.last().val()!=i.last().val()&&c.find(".MoveDown, .MoveBottom").removeClass("ms2side__hide")}}e.size()==0||b.maxSelected>=0&&e.size()>=b.maxSelected?c.find(".AddAll").addClass("ms2side__hide"):c.find(".AddAll").removeClass("ms2side__hide");i.size()==0?c.find(".RemoveAll").addClass("ms2side__hide"):c.find(".RemoveAll").removeClass("ms2side__hide")});
f.dblclick(function(){a(this).find("option:selected").each(function(c,e){if(b.maxSelected<0||g.children().size()<b.maxSelected){a(this).remove().appendTo(g);d.find("[value="+a(e).val()+"]").attr("selected",true).remove().appendTo(d)}});a(this).trigger("change")});g.dblclick(function(){a(this).find("option:selected").each(function(c,e){a(this).remove().appendTo(f);d.find("[value="+a(e).val()+"]").attr("selected",false).remove().appendTo(d)});a(this).trigger("change")});a(this).next().find(".ms2side__options").children().click(function(){if(!a(this).hasClass("ms2side__hide"))if(a(this).hasClass("AddOne"))f.find("option:selected").each(function(c,
e){a(this).remove().appendTo(g);d.find("[value="+a(e).val()+"]").attr("selected",true).remove().appendTo(d)});else if(a(this).hasClass("AddAll")){f.children().appendTo(g);f.children().remove();d.find("option").attr("selected",true)}else if(a(this).hasClass("RemoveOne"))g.find("option:selected").each(function(c,e){a(this).remove().appendTo(f);d.find("[value="+a(e).val()+"]").attr("selected",false).remove().appendTo(d)});else if(a(this).hasClass("RemoveAll")){g.children().appendTo(f);g.children().remove();
d.find("option").attr("selected",false)}f.trigger("change")});a(this).next().find(".ms2side__updown").children().click(function(){var c=g.find("option:selected"),e=g.find("option");if(!a(this).hasClass("ms2side__hide"))if(a(this).hasClass("SelSort")){e.sort(function(u,v){var p=a(u).text().toUpperCase(),q=a(v).text().toUpperCase();return p<q?-1:p>q?1:0});d.find("option:selected").remove();e.each(function(){g.append(a(this).clone().attr("selected",true));d.append(a(this).attr("selected",true))})}else if(a(this).hasClass("MoveUp")){var i=
c.first().prev(),m=d.find("[value="+i.val()+"]");c.each(function(){a(this).insertBefore(i);d.find("[value="+a(this).val()+"]").insertBefore(m)})}else if(a(this).hasClass("MoveDown")){var k=c.last().next(),w=d.find("[value="+k.val()+"]");c.each(function(){a(this).insertAfter(k);d.find("[value="+a(this).val()+"]").insertAfter(w)})}else if(a(this).hasClass("MoveTop")){var r=e.first(),x=d.find("[value="+r.val()+"]");c.each(function(){a(this).insertBefore(r);d.find("[value="+a(this).val()+"]").insertBefore(x)})}else if(a(this).hasClass("MoveBottom")){var n=
e.last(),s=d.find("[value="+n.val()+"]");c.each(function(){n=a(this).insertAfter(n);s=d.find("[value="+a(this).val()+"]").insertAfter(s)})}f.trigger("change")});a(this).next().find(".ms2side__options, .ms2side__updown").children().hover(function(){a(this).addClass("ms2side_hover")},function(){a(this).removeClass("ms2side_hover")});f.trigger("change");a(this).next().show()})}})(jQuery);
